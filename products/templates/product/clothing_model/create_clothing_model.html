{% extends "base_dash/dashboard_base.html" %}
{% load static %}
{% block content %}

<div class="container">
    <div class="row justify-content-center">
        <div class="col-6">
            <div class="card-body border-dark-subtle">
                <form method="post" id="clothing-model-form">
                    {% csrf_token %}
                
                    <div class="form-group row">
                        <label for="id_category">Article</label>
                        <select class="custom-select" id="id_article" name="article">
                            <option value="">Selecciona una categoría</option>
                            {% for article in article_list  %}
                            <option value="{{article.id}}" {% if article.id == object.article.id %}selected{% endif %}>{{ article.name}}</option>
                            {% empty %}
                            <option data-bs-toggle="modal" data-bs-target="#addItemModal">Sin registros</option>
                            {% endfor %}
                        </select>
                
                        <input type="text" class="form-control mt-2" id="inputArticle" placeholder="Clothing Model" name="name" value="{{ object.name }}">
                    </div>
                    <div class="form-group row">
                        <div class="col-sm-10 offset-sm-2">
                            <button type="submit" class="btn btn-primary"> <i class="fas fa-plus"></i> Create Clothing Model</button>
                        </div>
                    </div>
                </form>
                
            </div>
        </div>
    </div>
</div>

<div class="container">
    <div class="row">

            <div class="alert" id="clothing-model-alert" style="display: none;"></div>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="card-body">
            <table class="table table-bordered table-hover" id="categories-table">
                <thead>
                    <tr>
                        <th style="width: 10%;">#</th>
                        <th style="width: 40%;">Article</th>
                        <th style="width: 40%;">Clothing Model</th>
                        <th style="width: 10%;">Edit</th>
                        <!-- Otros encabezados de columna -->
                    </tr>
                </thead>
                <tbody>
                    {% for article in clothing_model_list %}
                    <tr>
                        <td>{{ article.id }}</td>
                        <td>{{ article.category }}</td>
                        <td>{{ article.name }}</td>
                        <td>
                            <a class="btn btn-info btn-sm" href="#">
                                <i class="fas fa-pencil-alt">
                                </i>

                            </a>
                            <a class="btn btn-danger btn-sm delete-object"
                                href="#">
                                <i class="fas fa-trash"></i>
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td>No hay Articles</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
    $(document).ready(function () {
        $("#clothing-model-form").on("submit", function (event) {
            event.preventDefault();
            var articleName = $("#inputArticle").val();
            var articleClotinge = $("#id_article").val();

            // Realiza una solicitud AJAX a tu vista de Django para agregar la categoría.
            $.ajax({
                url: ".",
                type: "POST",
                data: {
                    name: articleName,
                    article: articleCloting,
                    csrfmiddlewaretoken: $("input[name=csrfmiddlewaretoken]").val()
                },
                success: function (response) {

                    $("#inputArticle").val(""); // Limpia el campo de entrada.
                    $("#clothing-model-alert").html('<div class="alert alert-success" role="alert">Clothing Model agregada correctamente.</div>').show();

                    // Recarga la página después de un breve retraso (por ejemplo, 2 segundos).
                    setTimeout(function () {
                        location.reload();
                    }, 2000);

                },
                error: function (response) {
                    $("#clothing-model-alert").html('<div class="alert alert-danger" role="alert">Error al agregar la clothing model.</div>').show();
                }
            });
        });

    });
</script>


{% endblock %}